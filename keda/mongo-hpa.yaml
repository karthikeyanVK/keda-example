apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: mongo-scaledobject
  namespace: default
  labels:
    deploymentName: dummy-mongo
spec:
  maxReplicaCount: 5
  pollingInterval: 3  # Optional. Default: 30 seconds
  cooldownPeriod:  5 # Optional. Default: 300 seconds
  scaleTargetRef:
    name: dummy-mongo
  triggers:
    - type: mongodb
      metadata:
        host: "kubekochi2024.mongo.cosmos.azure.com"
        dbName: "kedademo"
        collection: "scalecollection"
        query: '{"name":"test"}'
        queryValue: "1"
        activationQueryValue: "1"
      authenticationRef:
        name: mongodb-trigger

---

apiVersion: keda.sh/v1alpha1
kind: TriggerAuthentication
metadata:
  name: mongodb-trigger
spec:
  secretTargetRef:
    - parameter: connectionString
      name: mongodb-secret
      key: connect

---

apiVersion: v1
kind: Secret
metadata:
  name: mongodb-secret
type: Opaque
data:
  connect: bW9uZ29kYjovL2t1YmVrb2NoaTIwMjQ6Rk1YcDhIQWtLRnNLV2pRZXJVQ1ExSHFscERWbFdNTUt2TlBYS3hEUGtHaEtJUFRxZVlkVVhxNUpTZk9CMzJMRVREQUttUGJXWHRYZEFDRGJLUDRXNFE9PUBrdWJla29jaGkyMDI0Lm1vbmdvLmNvc21vcy5henVyZS5jb206MTAyNTUva2VkYWRlbW8/c3NsPXRydWUmcmVwbGljYVNldD1nbG9iYWxkYg==
